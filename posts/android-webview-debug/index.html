<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title id="site-title">Android手机上Webview页面以及微信/QQ浏览器真机调试 | ccat3z's blog</title><link rel="icon" href="/favicon.png"><title>Android手机上Webview页面以及微信/QQ浏览器真机调试 | ccat3z’s blog</title><meta name="generator" content="Jekyll v3.8.5"><meta property="og:title" content="Android手机上Webview页面以及微信/QQ浏览器真机调试"><meta name="author" content="ccat3z"><meta property="og:locale" content="en_US"><meta name="description" content="转自Cango的Android手机上Webview页面以及微信/QQ浏览器真机调试"><meta property="og:description" content="转自Cango的Android手机上Webview页面以及微信/QQ浏览器真机调试"><link rel="canonical" href="//ccat3z.xyz/posts/android-webview-debug/"><meta property="og:url" content="//ccat3z.xyz/posts/android-webview-debug/"><meta property="og:site_name" content="ccat3z’s blog"><meta property="og:type" content="article"><meta property="article:published_time" content="2017-09-21T22:09:15+08:00"><script type="application/ld+json">{"headline":"Android手机上Webview页面以及微信/QQ浏览器真机调试","dateModified":"2017-09-21T22:09:15+08:00","datePublished":"2017-09-21T22:09:15+08:00","description":"转自Cango的Android手机上Webview页面以及微信/QQ浏览器真机调试","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"//ccat3z.xyz/posts/android-webview-debug/"},"url":"//ccat3z.xyz/posts/android-webview-debug/","author":{"@type":"Person","name":"ccat3z"},"@context":"https://schema.org"}</script><link href="https://cdn.bootcss.com/material-design-icons/3.0.1/iconfont/material-icons.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/vuetify@1.5.14/dist/vuetify.min.css" rel="stylesheet"><link href="/css/blog.4a6981b0b8a0cdf7086c.css" rel="stylesheet"></head><body><div id="blog"></div><div id="blog-data"><div id="blog-data-content"><div class="post"><div class="post-info"><a href="/posts/android-webview-debug/" class="post-title">Android手机上Webview页面以及微信/QQ浏览器真机调试 </a><span class="post-date">21 Sep 2017</span><p class="post-short-description">:D</p><ul class="post-tags"><li><a href="/tag/android" class="post-tag">Android</a></li></ul></div><div class="content"><blockquote><p>转自<a href="http://www.jianshu.com/u/84bd2b65f0c5">Cango</a>的<a href="http://www.jianshu.com/p/a06b5b8dc6b2">Android手机上Webview页面以及微信/QQ浏览器真机调试</a></p></blockquote><p>最近正在开发一个手机端微信的Vue SPA项目，遇到一个奇怪的问题，本地dev server上运行正常，打包部署后某些手机的微信浏览器或者手机浏览器运行页面白屏，由于是线上问题，而PC端也无法重现，先是想是不是某个外部js加载出错造成的，看了半天代码尝试优化也没解决问题，最后想到是否能通过调试手机端浏览器来定位。在网上查了一下，PC端Chrome已经实现远程调试移动设备WebView页面。</p><p>首先打开Android手机浏览器，我用的是小米手机自带的浏览器（不能用QQ手机浏览器官方版，Chrome检测不到，但是调试版可以，这个稍后再说）。在手机浏览器中打开需要调试的页面，然后使用USB连接PC与手机，在Chrome地址栏中输入<code class="highlighter-rouge">chrome://inspect</code>打开以下页面。</p><p><img src="/images/2017-09-21-android-webview-debug/chrome-inspect.png" alt=""></p><p>在上图中就可以看到我调试的页面<strong>行李旅宿</strong>，点击下边的inspect就会弹出与PC端Chrome一样的控制台界面，如下所示</p><p><img src="/images/2017-09-21-android-webview-debug/webview-dev.png" alt=""></p><p>这样就能在chrome控制台看到真机的布局样式和log了。接下来看看我的白屏问题当我打开首页的时候，在上边这个窗口的控制台打印出这个错误</p><p><img src="/images/2017-09-21-android-webview-debug/console-error.png" alt=""></p><p>不进行真机调试还真的看不到这个log，然后又是一系列的搜索调查终于找到问题所在。我这个Vue项目用的是ES6的语法，而Babel只是转换了新的JavaScript语法，而没有转换Object.assign, Promise等这种新的API，而我的入口JS中使用的Vue-Map就是使用了Object.assign从而造成主JS报错页面无法加载。解决方法就是<code class="highlighter-rouge">npm install babel-polyfill --save-dev</code>，然后在主JS的最上边加上<code class="highlighter-rouge">import 'babel-polyfill'</code>，重新打包部署运行，一切正常。（但有一个问题还没搞清楚，为什么本地运行正常，期待大神给些建议），以上就是Chromium内核浏览器的调试方法。</p><hr><p>跑步前进，接下来咱们看看如何真机调试Android的微信浏览器和QQ浏览器，这两种浏览器都是X5内核，使用Chrome的方式的话找不到手机页面。好在腾讯推出了一个神器，TBS Studio - <a href="http://bbs.mb.qq.com/thread-1416936-1-1.html">TBS Studio</a>介绍，X5浏览器的开发调试利器。</p><p>下载后运行后界面如下</p><p><img src="/images/2017-09-21-android-webview-debug/tbs-studio.png" alt=""></p><p>使用USB连接PC与手机，使用微信打开调试页面，点击启动检测</p><p><img src="/images/2017-09-21-android-webview-debug/wechat-debug.png" alt=""></p><p>检测到手机微信后，点击确定继续检测，走到step4会显示以下页面</p><p><img src="/images/2017-09-21-android-webview-debug/install-core.png" alt=""></p><p>此时，在手机上如果微信是新版本内核，则会弹出调试确认开关，如果是旧内核，则需要根据提示更新内核（大胆更新，不用担心），最后点击启动调试，则会弹出和Chrome Inspect相似的检测页面</p><p><img src="/images/2017-09-21-android-webview-debug/inspect-tool.png" alt=""></p><p>看到了我的调试页面<strong>行李旅宿</strong>，点击Inspect则会进入微信浏览器真机调试控制台，也是和Chrome很相似</p><p><img src="/images/2017-09-21-android-webview-debug/console.png" alt=""></p><p>这样就可以随心所欲的调试真机了，所有和微信浏览器环境的问题几乎都能在这里找到答案。QQ浏览器的调试方式和微信的一样，只是TBS会强行让你安装QQ浏览器调试版，换成调试版后，我发现Chrome也就能检测到QQ浏览器的页面了，很神奇。</p><p>最后，微信还有一个调试利器也很好用，就是微信web开发者工具，最早是和小程序开发工具分开发布的，开发者怨声载道最后集成到一起了，这个也能模拟微信的运行环境，在这里就不赘述了，详情请查看<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html">微信小程序工具</a>。</p><p>以上就是Android端常用浏览器的真机调试方法，有了这些，再也不担心那些产品环境bug过夜了。</p></div></div></div><div id="blog-data-page-pagination"></div><div id="blog-data-nav"><ul><li><a href="/" class="icon-home">home</a></li><li><a href="/posts/" class="icon-create">post</a></li><li><a href="/love/" class="icon-favorite">love</a></li></ul></div></div><script src="https://cdn.jsdelivr.net/npm/@babel/polyfill@7.4.4/dist/polyfill.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.runtime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vuetify@1.5.14/dist/vuetify.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="/js/blog.4a6981b0b8a0cdf7086c.js"></script></body></html>