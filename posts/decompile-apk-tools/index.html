<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><link rel="icon" href="/favicon.png"><!-- <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> --><!--SEO_BEGIN--><!-- Begin Jekyll SEO tag v2.7.1 --><title>Android反编译工具总结 | ccat3z.xyz</title><meta name="generator" content="Jekyll v4.2.0"/><meta property="og:title" content="Android反编译工具总结"/><meta name="author" content="ccat3z"/><meta property="og:locale" content="en_US"/><meta name="description" content="我… 我就想学习一下 QwQ 绝对不会抢红包什么的"/><meta property="og:description" content="我… 我就想学习一下 QwQ 绝对不会抢红包什么的"/><link rel="canonical" href="//ccat3z.xyz/posts/decompile-apk-tools/"/><meta property="og:url" content="//ccat3z.xyz/posts/decompile-apk-tools/"/><meta property="og:site_name" content="ccat3z.xyz"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2017-08-21T01:05:20+08:00"/><meta name="twitter:card" content="summary"/><meta property="twitter:title" content="Android反编译工具总结"/><script type="application/ld+json">{"@type":"BlogPosting","headline":"Android反编译工具总结","dateModified":"2017-08-21T01:05:20+08:00","datePublished":"2017-08-21T01:05:20+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"//ccat3z.xyz/posts/decompile-apk-tools/"},"author":{"@type":"Person","name":"ccat3z"},"description":"我… 我就想学习一下 QwQ 绝对不会抢红包什么的","url":"//ccat3z.xyz/posts/decompile-apk-tools/","@context":"https://schema.org"}</script><!-- End Jekyll SEO tag --><!--SEO_END--><link href="/static/css/main.3b94f4c9.chunk.css" rel="stylesheet"></head><body><div id="blog"></div><div id="blog-data"><div id="blog-data-content"><div class="post"><div class="post-info"><span class="post-id">/posts/decompile-apk-tools</span> <a href="/posts/decompile-apk-tools/" class="post-title">Android反编译工具总结 </a><span class="post-date">21 Aug 2017</span><p class="post-description">我... 我就想学习一下 QwQ 绝对不会抢红包什么的</p><ul class="post-tags"><li><a href="/tag/android/" class="post-tag">Android</a></li></ul></div><div class="content"><blockquote><p>转自<a href="http://sunzq1993.com/2017/03/19/Android反编译工具总结/">Android反编译工具总结</a></p></blockquote><blockquote><p>最近想写自己写个apk，但是苦于没有本人不会ui、不会ps（那我会啥 ╮(╯▽╰)╭），就会敲代码，so 就反编译了下我感觉ui好看的apk，反编译了这么多个apk希望不要被抓到（::&gt;_&lt;::）……</p></blockquote><p>首先来简单的说明下Apk文件本质上其实是一个zip包。我们直接进行解压就能看到其中的目录。</p><p><img src="/images/2017-08-21-decompile-apk-tools/dir.png" alt=""/></p><h2 id="目录说明">目录说明</h2><ul><li>AndroidManifest.xml：应用的全局配置文件</li><li>classes.dex：源代码编译成class后，转成jar，再压缩成dex文件，dex是可以直接在Android虚拟机上运行的文件。</li><li>lib文件夹：引用的第三方sdk的so文件。</li><li>META-INF文件夹：Apk签名文件。</li><li>res文件夹：资源文件，包括了布局、图片等等。</li><li>resources.arsc：记录资源文件和资源id的映射关系。</li><li>其中还有一个没有显示就是→assets文件夹：原始资源文件夹，对应着Android工程的assets文件夹，一般用于存放原始的网页、音频等等。</li><li>上述的这些说明 简单的说明了一个apk基本包含的东西，直接把apk解压是没有办法进行阅读的，在打包这个过程中经过了build-tools处理了。</li></ul><p>其实反编译Apk的目的就是Apk拆成我们可以阅读的文件。通过反编译，我们一般想要得到里面的AndroidManifest.xml文件、res文件和java代码。</p><p>我将介绍3个工具来对apk进行反编译</p><h2 id="1利用apktool获取androidmanifest和res等资源文件">1.利用ApkTool，获取AndroidManifest和res等资源文件</h2><p>怎么得到Apk下的资源文件，这是个问题，我上网查找是发现了ApkTool工具，当时给我的感觉就好像是发现新大陆一样</p><p><a href="https://ibotpeaches.github.io/Apktool/">工具地址</a></p><p>功能：拆解Apk文件，反编译其中的资源文件，将它们反编译为可阅读的AndroidManifest.xml文件和res文件。因为直接把Apk文件当做zip解压，得到的xml资源文件，都是无法直接用文本编辑器打开阅读的，因为它们在打包时经过了build-tools的处理。</p><p><a href="https://ibotpeaches.github.io/Apktool/install/">安装</a> 最新版本是2.2 需要的环境是jdk 1.7以上</p><blockquote><ul><li>下载apktool-2（<a href="https://bitbucket.org/iBotPeaches/apktool/downloads/">最新</a>）</li><li>将下载的jar重命名为 apktool.jar</li><li>将这两个文件（apktool.jar＆apktool.bat）移动到您的Windows目录（通常C://Windows）</li><li>如果没有访问权限C://Windows，可以将这两个文件放在任何位置，然后将该目录添加到您的环境变量系统PATH变量。</li><li>尝试apktool通过命令提示符运行</li></ul></blockquote><p>下面我在win10 上演示如何利用ApkTool 进行反编译的</p><p>上述说到如果你把文件移动到其他的位置，就需要配置环境变量，上述有提到</p><p>首先进入到你想要 反编译的apk 目录下，我为了方便就放置到一起了。</p><p><img src="/images/2017-08-21-decompile-apk-tools/apktool.png" alt=""/></p><p>我们可以从下图看到反编译出来的具体内容</p><p><img src="/images/2017-08-21-decompile-apk-tools/apktool_content.png" alt=""/></p><p>我们已经得到一个可以用文本编辑器打开的阅读的AndroidManifest.xml文件、assets文件夹、res文件夹、smali文件夹等等。original文件夹是原始的AndroidManifest.xml文件，res文件夹是反编译出来的所有资源，smali文件夹是反编译出来的代码。这里smali 不做说明。</p><p>这时，我们已经可以文本编辑器打开AndroidManifest.xml文件和res下面的layout文件了。这样，我们就可以查看到这个Apk文件的package包名、Activity组件、程序所需要的权限、xml布局、图标等等信息。</p><p><a href="https://ibotpeaches.github.io/Apktool/documentation/">其他用法</a></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> apktool.jar d test.apk
<span class="nt">-f</span> 如果目标文件夹已存在，强制删除现有文件夹
<span class="nt">-o</span> 指定反编译的目标文件夹的名称（默认会将文件输出到以Apk文件名命名的文件夹中）
<span class="nt">-s</span> 保留classes.dex文件（默认会将dex文件解码成smali文件）
<span class="nt">-r</span> 保留resources.arsc文件（默认会将resources.arsc解码成具体的资源文件）
  
// 注意<span class="sb">`</span>apktool.jar<span class="sb">`</span>是刚才下载后的jar的名称，<span class="sb">`</span>d<span class="sb">`</span>参数表示decode
// 在这个命令后面还可以添加像<span class="sb">`</span><span class="nt">-o</span> <span class="nt">-s</span><span class="sb">`</span>之类的参数，例如
// java <span class="nt">-jar</span> apktool.jar d yourApkFile.apk <span class="nt">-o</span> destiantionDir <span class="nt">-s</span>
// 几个主要的参数设置方法及其含义：
</code></pre></div></div><h2 id="2利用dex2jar反编译dex文件得到java源代码">2.利用dex2jar反编译dex文件，得到java源代码</h2><p>在上面说到我们通过apkTool反编译获得apk 等资源文件，如果你想获取源代码呢，怎么办，这时候就需要dex2jar登场了。</p><p><a href="https://github.com/pxb1988/dex2jar">工具地址</a></p><p>功能：将dex格式的文件，转换成jar文件。dex文件时Android虚拟机上面可以执行的文件，jar文件大家都是知道，其实就是java的class文件。在官网有详细介绍。</p><p>安装： 打开下载的文件进行解压后进入/dex2jar目录下，里面有脚本本件，进入终端后，输入命令就可以使用啦。</p><p>使用： 利用终端进入到你的dex2jar目录下，输入命令进行获取</p><p><img src="/images/2017-08-21-decompile-apk-tools/dex2jar.png" alt=""/></p><p>这个时候就有人问我，你那个classes.dex是怎么获得的，其实在我最开始讲述的时候说过，把apk解压下来就能获得classes.dex文件，之后赋值到dex2jar目录下 ，执行命令。</p><p>这个时候又有人问我了（怎么这么多人问我），我怎么看生成的这个jar包呀。这个时候就需要 jd-gui了</p><h3 id="21-jd-gui查看java源代码">2.1 jd-gui查看java源代码</h3><p>工具下载地址：<a href="http://jd.benow.ca/">官网</a>上选择自己所需要的版本，<a href="https://github.com/java-decompiler/jd-gui">github</a></p><p>用法： 下载完成后直接打开，把生成的classes-dex2jar.jar 文件直接拖到里面就可以观看了</p><p><img src="/images/2017-08-21-decompile-apk-tools/jd-gui.png" alt=""/></p><h2 id="3jadx反编译akp得到java源代码">3.jadx反编译Akp，得到.java源代码</h2><blockquote><p>介绍： 又双人问我有没有直接生成.java文件的，我说有啊，那就是是是是jadx</p></blockquote><p>其中我在上网查找之前apktool+dex2jar+jd-gui一直是一个比较流行的Android反编译组合。</p><p>功能 ： 但是jadx具有以下两个优点</p><p>可以直接反编译出.java文件 查看源码时直接显示资源名称，而不是像jd-gui里显示的资源ID 工具地址 ：</p><blockquote><ul><li><a href="https://github.com/skylot/jadx/releases">github</a></li><li><a href="http://sourceforge.net/projects/jadx/files/">sourceforge</a></li></ul></blockquote><p>安装： 下载完成后进行解压</p><p>使用： 进入bin目录下执行jadx-gui.bat，jadx也有GUI，进入后选中然将要反编译的apk即可，运行效果如下。</p><p><img src="/images/2017-08-21-decompile-apk-tools/jadx.png" alt=""/></p><p>Android反编译工具总结</p><p>如果要保存源码，选择File-&gt;Save ALL即可保存文件，然后就可以导入Android Studio等IDE中。我们也可以直接使用命令行反编译apk文件：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jadx <span class="nt">-d</span> out classes.dex  <span class="c">#直接输出.java文件到out目录</span>
jadx-gui classes.dex <span class="c">#使用gui打开</span>
</code></pre></div></div><p>现在你就可以用到jadx啦，不过获取资源等文件我还是建议使用ApkTool</p><h2 id="4classyshark谷歌亲儿子-你知道">4.ClassyShark谷歌亲儿子 你知道</h2><p><a href="https://github.com/google/android-classyshark/releases">工具地址</a></p><p>功能：可直接浏览 Apk中的xml文件等，支持对.dex, .aar, .so，.apk, .jar, .class等文件的操作。</p><p>安装： 下载ClassyShark.jar后直接点击使用就可以了。</p><p>用法： 直接点击左上角打开你想要解析的apk就可以啦。</p><blockquote><p>它可以直观的看到Apk 下每个包中的方法数，并且以直观的扇形图展示在右边。（这里面直接使用的是内涵段子的apk）</p><p>这个时候就可以看到apk 下用到的第三方框架啦</p></blockquote><p><img src="/images/2017-08-21-decompile-apk-tools/classyshark.png" alt=""/></p><p>同时你可以直接看到所使用的 xml 文件等布局文件，同时你也可以看到apk下所包含的方法数是多少以及它使用的开源库等信息。</p><p><img src="/images/2017-08-21-decompile-apk-tools/classyshark_1.png" alt=""/></p><p><img src="/images/2017-08-21-decompile-apk-tools/classyshark_2.png" alt=""/></p><h2 id="总结">总结</h2><p>其实还有有两个没有介绍到enjarify 、 Procyon 这个两个讲下之后进行更新</p><p>其实我们反编译apk，就是进行更多的学习，想看看其他apk的具体逻辑是怎么实现的，如果你想要只是简单的获得资源等文件只用apkTool就可以啦。</p><p>以上的几个工具给我的感觉还是不错的，基本可以实现我现在的需求（毕竟我只需要获得资源文件就好了）</p><h3 id="参考">参考</h3><p><a href="http://blog.coderclock.com/2016/07/04/android/%E9%82%A3%E4%BA%9B%E5%80%BC%E5%BE%97%E4%BD%A0%E8%AF%95%E8%AF%95%E7%9A%84Android%E7%AB%9E%E5%93%81%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/">那些值得你试试的Android竞品分析工具</a></p><p><a href="https://unclechen.github.io/2016/09/07/Android%E5%8F%8D%E7%BC%96%E8%AF%91%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/">Android反编译技术总结</a></p></div></div></div><div id="blog-data-page-pagination"></div><div id="blog-data-nav"><ul><li><a href="/" class="icon-home">home</a></li><li><a href="/posts/" class="icon-create">post</a></li><li><a href="/love/" class="icon-favorite">love</a></li></ul></div></div><script src="/static/js/runtime-main.26ceb475.js"></script><script src="/static/js/2.4c4b9d9d.chunk.js"></script><script src="/static/js/main.e5921d51.chunk.js"></script></body></html>