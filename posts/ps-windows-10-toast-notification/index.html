<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><link rel="icon" href="/favicon.png"><!-- <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> --><!--SEO_BEGIN--><!-- Begin Jekyll SEO tag v2.7.1 --><title>How to create windows 10 toast notification with PowerShell? | ccat3z.xyz</title><meta name="generator" content="Jekyll v4.2.0"/><meta property="og:title" content="How to create windows 10 toast notification with PowerShell?"/><meta name="author" content="ccat3z"/><meta property="og:locale" content="en_US"/><meta name="description" content="直接抄…"/><meta property="og:description" content="直接抄…"/><link rel="canonical" href="//ccat3z.xyz/posts/ps-windows-10-toast-notification/"/><meta property="og:url" content="//ccat3z.xyz/posts/ps-windows-10-toast-notification/"/><meta property="og:site_name" content="ccat3z.xyz"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2017-03-17T22:14:50+08:00"/><meta name="twitter:card" content="summary"/><meta property="twitter:title" content="How to create windows 10 toast notification with PowerShell?"/><script type="application/ld+json">{"datePublished":"2017-03-17T22:14:50+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"//ccat3z.xyz/posts/ps-windows-10-toast-notification/"},"url":"//ccat3z.xyz/posts/ps-windows-10-toast-notification/","author":{"@type":"Person","name":"ccat3z"},"headline":"How to create windows 10 toast notification with PowerShell?","dateModified":"2017-03-17T22:14:50+08:00","description":"直接抄…","@context":"https://schema.org"}</script><!-- End Jekyll SEO tag --><!--SEO_END--><link href="/static/css/main.d91be9b8.chunk.css" rel="stylesheet"></head><body><div id="blog"></div><div id="blog-data"><div id="blog-data-content"><div class="post"><div class="post-info"><span class="post-id">/posts/ps-windows-10-toast-notification</span> <a href="/posts/ps-windows-10-toast-notification/" class="post-title">How to create windows 10 toast notification with PowerShell? </a><span class="post-date">17 Mar 2017</span><p class="post-description">直接抄…</p><ul class="post-tags"><li><a href="/tag/windows/" class="post-tag">Windows</a></li></ul></div><div class="content"><p>直接抄…</p><div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">$Error</span><span class="n">ActionPreference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Stop"</span><span class="w">

</span><span class="nv">$notificationTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Notification: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">[</span><span class="n">DateTime</span><span class="p">]::</span><span class="n">Now.ToShortTimeString</span><span class="p">()</span><span class="w">

</span><span class="p">[</span><span class="n">Windows.UI.Notifications.ToastNotificationManager</span><span class="p">,</span><span class="w"> </span><span class="n">Windows.UI.Notifications</span><span class="p">,</span><span class="w"> </span><span class="n">ContentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WindowsRuntime</span><span class="p">]</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">
</span><span class="nv">$template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Windows.UI.Notifications.ToastNotificationManager</span><span class="p">]::</span><span class="n">GetTemplateContent</span><span class="p">([</span><span class="n">Windows.UI.Notifications.ToastTemplateType</span><span class="p">]::</span><span class="n">ToastText01</span><span class="p">)</span><span class="w">

</span><span class="c">#Convert to .NET type for XML manipuration</span><span class="w">
</span><span class="nv">$toastXml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">xml</span><span class="p">]</span><span class="w"> </span><span class="nv">$template</span><span class="o">.</span><span class="nf">GetXml</span><span class="p">()</span><span class="w">
</span><span class="nv">$toastXml</span><span class="o">.</span><span class="nf">GetElementsByTagName</span><span class="p">(</span><span class="s2">"text"</span><span class="p">)</span><span class="o">.</span><span class="nf">AppendChild</span><span class="p">(</span><span class="nv">$toastXml</span><span class="o">.</span><span class="nf">CreateTextNode</span><span class="p">(</span><span class="nv">$notificationTitle</span><span class="p">))</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">

</span><span class="c">#Convert back to WinRT type</span><span class="w">
</span><span class="nv">$xml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">Windows.Data.Xml.Dom.XmlDocument</span><span class="w">
</span><span class="nv">$xml</span><span class="o">.</span><span class="nf">LoadXml</span><span class="p">(</span><span class="nv">$toastXml</span><span class="o">.</span><span class="nf">OuterXml</span><span class="p">)</span><span class="w">

</span><span class="nv">$toast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Windows.UI.Notifications.ToastNotification</span><span class="p">]::</span><span class="n">new</span><span class="p">(</span><span class="nv">$xml</span><span class="p">)</span><span class="w">
</span><span class="nv">$toast</span><span class="o">.</span><span class="nf">Tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PowerShell"</span><span class="w">
</span><span class="nv">$toast</span><span class="o">.</span><span class="nf">Group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PowerShell"</span><span class="w">
</span><span class="nv">$toast</span><span class="o">.</span><span class="nf">ExpirationTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">DateTimeOffset</span><span class="p">]::</span><span class="n">Now.AddMinutes</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">
</span><span class="c">#$toast.SuppressPopup = $true</span><span class="w">

</span><span class="nv">$notifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Windows.UI.Notifications.ToastNotificationManager</span><span class="p">]::</span><span class="n">CreateToastNotifier</span><span class="p">(</span><span class="s2">"PowerShell"</span><span class="p">)</span><span class="w">
</span><span class="nv">$notifier</span><span class="o">.</span><span class="nf">Show</span><span class="p">(</span><span class="nv">$toast</span><span class="p">);</span><span class="w">
</span></code></pre></div></div></div></div></div><div id="blog-data-page-pagination"></div><div id="blog-data-nav"><ul><li><a href="/" class="icon-home">home</a></li><li><a href="/posts/" class="icon-create">post</a></li></ul></div></div><script>const dataElement=document.getElementById("blog-data");dataElement&&dataElement.setAttribute("style","display: none;")</script><script src="/static/js/runtime-main.26ceb475.js"></script><script src="/static/js/2.4c4b9d9d.chunk.js"></script><script src="/static/js/main.ba7c982e.chunk.js"></script></body></html>