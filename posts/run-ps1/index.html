<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title id="site-title">PowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶ | c0ldcat's blog</title> <link rel="icon" href="/c0ldcat.png"> <link rel="stylesheet" type="text/css" href="/css/main.css"> <link rel="alternate" type="application/rss+xml" title="RSS Feed for c0ldcat's blog" href="/feed.xml" /> <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> <script type="text/javascript" src="/js/jquery.typetype.min.js"></script> <script> var _hmt = _hmt || []; (function () { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?e1acee033923881f5528a3b4a658039b"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> <style> .block-left { background-size: cover; background-position-x: right; } </style> <!-- Begin Jekyll SEO tag v2.4.0 --> <title>PowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶ | c0ldcatâ€™s blog</title> <meta name="generator" content="Jekyll v3.7.3" /> <meta property="og:title" content="PowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶" /> <meta name="author" content="c0ldcat" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="è½¬è½½è‡ªPowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶" /> <meta property="og:description" content="è½¬è½½è‡ªPowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶" /> <link rel="canonical" href="//blog.c0ldcat.ml/posts/run-ps1/" /> <meta property="og:url" content="//blog.c0ldcat.ml/posts/run-ps1/" /> <meta property="og:site_name" content="c0ldcatâ€™s blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2017-03-30T23:28:09+08:00" /> <script type="application/ld+json"> {"@type":"BlogPosting","datePublished":"2017-03-30T23:28:09+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"//blog.c0ldcat.ml/posts/run-ps1/"},"url":"//blog.c0ldcat.ml/posts/run-ps1/","author":{"@type":"Person","name":"c0ldcat"},"description":"è½¬è½½è‡ªPowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶","headline":"PowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶","dateModified":"2017-03-30T23:28:09+08:00","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="block-left"> <div class="content"> <div class="main-info"> <a href="/" class="logo"><img src="/images/c0ldcat-pure-white.svg" class="logo"></a> <h1> <span id="author-name">c0ldcat</span><span>&#39;s blog</span> </h1> <ul> <li><a href="/posts">ğŸ–Šï¸</a></li> <li><a href="/projects">ğŸˆ</a></li> <li><a href="/tags">ğŸ”–</a></li> <li><a href="/love">â¤ï¸</a></li> </ul> </div> </div> <canvas></canvas> </div> <div id="pages" class="block-right"> <div class="inner-post content"> <h1>PowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶</h1> <div class="date-highlight">30 Mar 2017</div> <blockquote> <p>è½¬è½½è‡ª<a href="http://www.splaybow.com/post/powershellexecps1.html">PowerShellè®©ç³»ç»Ÿå¯ä»¥æ‰§è¡Œ.ps1æ–‡ä»¶</a></p> </blockquote> <p>.ps1æ–‡ä»¶æ˜¯PowerShellå†™å¥½çš„è„šæœ¬æ–‡ä»¶ã€‚åœ¨Windowsç³»ç»Ÿä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å…è®¸æ‰§è¡Œ.ps1æ–‡ä»¶çš„ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½è®©ç³»ç»Ÿå…è®¸æ‰§è¡Œ.ps1æ–‡ä»¶å‘¢ï¼Ÿ</p> <h1 id="ä»€ä¹ˆæ˜¯ps1æ–‡ä»¶">ä»€ä¹ˆæ˜¯<code class="highlighter-rouge">.ps1</code>æ–‡ä»¶ï¼Ÿ</h1> <p>è¿™ä¸ªæ˜¯PowerShellå†™çš„è„šæœ¬æ–‡æœ¬ï¼Œä½ å¯ä»¥åœ¨è®°äº‹æœ¬ä¸­å†™ä¸€æ®µPowerShellä»£ç ï¼Œç„¶åå°†å…¶ä¿å­˜ä¸ºâ€œxxx.ps1â€ï¼Œåé¢è¦ä½¿ç”¨å®ƒçš„æ—¶å€™ï¼ŒåŒå‡»å³å¯è¿è¡Œäº†ã€‚è¿™æœ‰ç‚¹åƒæ‰¹å¤„ç†çš„â€œ.batâ€æ–‡ä»¶ï¼Œä¹Ÿæœ‰ç‚¹åƒVBScriptçš„â€œ.vbsâ€æ–‡ä»¶ã€‚è¿™äº›éƒ½æ˜¯Windowsçš„è„šæœ¬æ–‡ä»¶ã€‚</p> <h1 id="å¦‚ä½•æ‰§è¡Œps1æ–‡ä»¶">å¦‚ä½•æ‰§è¡Œ<code class="highlighter-rouge">.ps1</code>æ–‡ä»¶ï¼Ÿ</h1> <p>æ¥ä¸‹æ¥å¤§å®¶ä¼šé—®ï¼Œé‚£æˆ‘ä»¬å°±åŒå‡»å®ƒè¿è¡Œå¥½äº†ï¼Œè¿˜æœ‰ä»€ä¹ˆå¥½è¯´çš„å—ï¼Ÿå½“ç„¶è¦è¯´ã€‚æˆ‘ä»¬æƒ³å¾—å¾ˆç¾ï¼ŒåŒå‡»ä¸€ä¸‹å°±æ‰§è¡Œäº†ï¼Œä½†æ˜¯Windowsç³»ç»Ÿé»˜è®¤æ˜¯ä¸å…è®¸æ‰§è¡Œ.ps1æ–‡ä»¶çš„ï¼Œæ‰€ä»¥ä½ å¾—å¾€ä¸‹çœ‹ã€‚</p> <h1 id="æ‰§è¡Œä¸æˆåŠŸçš„è§£å†³åŠæ³•">æ‰§è¡Œä¸æˆåŠŸçš„è§£å†³åŠæ³•</h1> <ol> <li>å°†PowerShellçš„è„šæœ¬å†…å®¹ä¿å­˜åˆ°ä¸€ä¸ª.ps1ä¸ºåç¼€çš„æ–‡ä»¶ä¸­ã€‚</li> <li>åŒå‡»æ‰§è¡Œæ­¤ps1æ–‡ä»¶å¾ˆæœ‰å¯èƒ½æ— æ³•æ‰§è¡Œï¼Œæç¤ºï¼šæ— æ³•åŠ è½½æ–‡ä»¶ D:\PowerShell\test\myfirst1.ps1ï¼Œå› ä¸ºåœ¨æ­¤ç³»ç»Ÿä¸­ç¦æ­¢æ‰§è¡Œè„šæœ¬ã€‚</li> <li>è¿è¡Œget-executionpolicyï¼Œå¦‚æœç»“æœæ˜¯Restrictedï¼Œé‚£è¡¨ç¤ºç¦æ­¢æ‰§è¡Œè„šæœ¬ã€‚</li> <li>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œé™ä½ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå…è®¸æ‰§è¡Œè„šæœ¬ï¼š<code class="highlighter-rouge">set-executionpolicy -executionpolicy unrestricted</code></li> </ol> <h1 id="å…³äºæ‰§è¡Œç­–ç•¥">å…³äºæ‰§è¡Œç­–ç•¥</h1> <p>è¿™é‡Œæœ‰ä¸€ä¸ªexecutionpolicyï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯æ‰§è¡Œç­–ç•¥ã€‚Windowså¯¹PowerShellè„šæœ¬é»˜è®¤çš„æ‰§è¡Œç­–ç•¥æ˜¯ï¼šä¸å…è®¸æ‰§è¡Œï¼Œå³Restrictedã€‚æŠŠå®ƒæ”¹æˆunrestrictedè‡ªç„¶å°±å¯ä»¥æ‰§è¡Œäº†ã€‚ä½†å¾®è½¯ç»™å‡ºçš„Best Practiseï¼ˆâ€œæœ€ä½³å®è·µâ€ï¼‰æ˜¯RemoteSignedï¼Œè¿™ä¸ªçº§åˆ«æ¯”UnRestrictedè¦é«˜ä¸€ç‚¹ï¼Œä¸æ˜¯ä»€ä¹ˆç¨‹åºéƒ½èƒ½æ‰§è¡Œã€‚æ®æˆ‘ç®€å•çš„äº†è§£ï¼ŒRemoteSignedæ˜¯è¦æ±‚è¿œç¨‹ä¸‹è½½çš„ps1è„šæœ¬æ–‡ä»¶å¿…é¡»æ˜¯ç­¾åçš„æ‰å¯ä»¥æ‰§è¡Œã€‚è‡³äºæˆ‘ä»¬åœ¨æœ¬æœºä¸Šè‡ªå†™çš„è„šæœ¬ç¨‹åºï¼Œé‚£æ˜¯æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½å¯ä»¥æ‰§è¡Œçš„ã€‚</p> <h1 id="ä¿®æ”¹æ‰§è¡Œç­–ç•¥éœ€è¦æƒé™">ä¿®æ”¹æ‰§è¡Œç­–ç•¥éœ€è¦æƒé™</h1> <p>å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœæ˜¯åœ¨Win7ã€Win8ã€Windows 2008ã€Windows 2012ç­‰ç³»ç»Ÿä¸Šï¼Œä¸”ä¸æ˜¯ä½¿ç”¨administratorè´¦å·æ¥æ‰§è¡Œè¿™ä¸ªset-executionpolicyè¯­å¥ï¼Œå°†ä¼šæŠ¥é”™ï¼Œé”™è¯¯å¦‚ä¸‹ï¼š Set-ExecutionPolicy : å¯¹æ³¨å†Œè¡¨é¡¹<span style="word-break: break-all;">KEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell</span>çš„è®¿é—®è¢«æ‹’ç»ã€‚ è´¦å·è™½ç„¶ä¸æ˜¯administratorï¼Œä½†ä¹Ÿæ˜¯administratorsç»„çš„ï¼Œä¸ºä»€ä¹ˆä¼šæ²¡æœ‰æƒé™å‘¢ï¼Ÿä¸ç®¡äº†ï¼Œåœ¨æ³¨å†Œè¡¨ä¸­ï¼Œæ‰¾åˆ°è¿™ä¸ªé”®ï¼Œç„¶åç‚¹å³é”®é€‰æ‹©â€œæƒé™â€ï¼Œç„¶åç»™å½“å‰ç™»å½•ç³»ç»Ÿçš„è´¦å·åŠ ä¸€ä¸ªâ€œå®Œå…¨æ§åˆ¶â€çš„æƒé™ï¼ˆåªæœ‰â€œåªè¯»â€å’Œâ€œå®Œå…¨æ§åˆ¶â€ä¸¤ä¸ªæƒé™ï¼Œæ‰€ä»¥å°±é€‰â€œå®Œå…¨æ§åˆ¶â€äº†ï¼‰ã€‚ç„¶åï¼Œå†é‡æ–°æ‰§è¡Œ<code class="highlighter-rouge">set-executionpolicy -executionpolicy unrestricted</code>ï¼Œå°±å¯ä»¥æˆåŠŸäº†ï¼</p> <div class="date-highlight"> <!--1--> <a class="tag" href="/tag/windows">Windows</a> </div> </div> </div> <script src="/js/canvas.js"></script> <script> (function() { var img = new Image(); function getResult(event) { var imgType = "png"; (event && event.type === 'load' ? img.width == 1 : false) && (imgType = "webp"); $(".block-left").css("background-image", "linear-gradient(rgba(44, 45, 51, 0.8), rgba(44, 45, 51, 0.8)), url(/images/background.png)".replace(/\.png/,"." + imgType)); } img.onerror = getResult; img.onload = getResult; img.src = 'data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA='; })(); </script> </body> </html>
