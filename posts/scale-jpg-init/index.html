<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title id="site-title">发一个小工具-Scale JPG | ccat3z's blog</title> <link rel="icon" href="/favicon.png"> <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> --> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>发一个小工具-Scale JPG | ccat3z’s blog</title> <meta name="generator" content="Jekyll v3.8.3" /> <meta property="og:title" content="发一个小工具-Scale JPG" /> <meta name="author" content="ccat3z" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="前面全是废话, 直接跳到怎么用" /> <meta property="og:description" content="前面全是废话, 直接跳到怎么用" /> <link rel="canonical" href="//ccat3z.xyz/posts/scale-jpg-init/" /> <meta property="og:url" content="//ccat3z.xyz/posts/scale-jpg-init/" /> <meta property="og:site_name" content="ccat3z’s blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2017-04-07T22:06:28+08:00" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"//ccat3z.xyz/posts/scale-jpg-init/","headline":"发一个小工具-Scale JPG","dateModified":"2017-04-07T22:06:28+08:00","datePublished":"2017-04-07T22:06:28+08:00","author":{"@type":"Person","name":"ccat3z"},"description":"前面全是废话, 直接跳到怎么用","mainEntityOfPage":{"@type":"WebPage","@id":"//ccat3z.xyz/posts/scale-jpg-init/"},"@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> <link href="https://cdn.bootcss.com/material-design-icons/3.0.1/iconfont/material-icons.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/vuetify@1.1.14/dist/vuetify.min.css" rel="stylesheet"><link href="/css/blog.db2021ef5bad500114c7.css" rel="stylesheet"></head> <body> <div id="blog"></div> <div id="blog-data"> <div id="blog-data-content"><div class="post"> <div class="post-info"> <a href="/posts/scale-jpg-init/" class="post-title">发一个小工具-Scale JPG </a> <span class="post-date">07 Apr 2017</span> </h2> <p class="post-short-description">JavaFX突然登场</p> <ul class="post-tags"> <li><a href="/tag/javafx" class="post-tag">JavaFX</a></li> <li><a href="/tag/project" class="post-tag">Project</a></li> </ul> </div> <div class="content"> <p>前面全是废话, 直接跳到<a href="#怎么用">怎么用</a></p> <p>前几天在报自招, 照片材料文件限制真的非常麻烦啊…</p> <p>于是我随手写了一串脚本:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-d</span> out_small_data <span class="o">]</span><span class="p">;</span><span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"out_small_data dir existed."</span>
    <span class="nb">read</span> <span class="nt">-n</span> 1 <span class="nt">-p</span> <span class="s2">"remove it?[y/N]"</span> answer
    <span class="nb">echo
    </span><span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$answer</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"y"</span> <span class="o">]</span><span class="p">;</span><span class="k">then
        </span><span class="nb">rm</span> <span class="nt">-rf</span> out_small_data
    <span class="k">else
        </span><span class="nb">exit
    </span><span class="k">fi
fi

</span><span class="nb">cp </span>data out_small_data <span class="nt">-r</span>

<span class="nb">cd </span>out_small_data

<span class="nv">FILE_SIZE</span><span class="o">=</span>300k
<span class="nv">QUALITY</span><span class="o">=</span>50
<span class="nv">SIZE</span><span class="o">=</span>100

<span class="k">while</span> <span class="o">[</span> <span class="s2">"</span><span class="k">$(</span>find ./ <span class="nt">-regex</span> <span class="s1">'.*\(jpg\|JPG\|png\|jpeg\)'</span> <span class="nt">-size</span> +<span class="nv">$FILE_SIZE</span> | <span class="nb">sed</span> <span class="s2">"s/^</span><span class="se">\.\/</span><span class="s2">//"</span><span class="k">)</span><span class="s2">x"</span> <span class="o">!=</span> <span class="s2">"x"</span> <span class="o">]</span>
<span class="k">do
    for </span>f <span class="k">in</span> <span class="k">$(</span>find ./ <span class="nt">-regex</span> <span class="s1">'.*\(jpg\|JPG\|png\|jpeg\)'</span> <span class="nt">-size</span> +<span class="nv">$FILE_SIZE</span> | <span class="nb">sed</span> <span class="s2">"s/^</span><span class="se">\.\/</span><span class="s2">//"</span><span class="k">)</span>
    <span class="k">do</span>
        <span class="c">#echo "converting $f with $QUALITY% quality..."</span>
        <span class="nb">echo</span> <span class="s2">"converting </span><span class="nv">$f</span><span class="s2"> with </span><span class="nv">$SIZE</span><span class="s2">% size..."</span>
        <span class="nb">mv</span> <span class="nv">$f</span> <span class="s2">"tmp</span><span class="nv">$f</span><span class="s2">"</span>
        convert <span class="nt">-quality</span> <span class="k">${</span><span class="nv">QUALITY</span><span class="k">}</span> <span class="s2">"tmp</span><span class="nv">$f</span><span class="s2">"</span> <span class="s2">"tmp2</span><span class="nv">$f</span><span class="s2">"</span>
        convert <span class="nt">-resize</span> <span class="nv">$SIZE</span>%x<span class="nv">$SIZE</span>% <span class="s2">"tmp2</span><span class="nv">$f</span><span class="s2">"</span> <span class="nv">$f</span>
        <span class="nb">rm</span> <span class="s2">"tmp</span><span class="nv">$f</span><span class="s2">"</span> <span class="s2">"tmp2</span><span class="nv">$f</span><span class="s2">"</span>
    <span class="k">done
    </span><span class="nv">QUALITY</span><span class="o">=</span><span class="k">$((</span><span class="nv">$QUALITY</span> <span class="o">-</span> <span class="m">1</span><span class="k">))</span>
    <span class="nv">SIZE</span><span class="o">=</span><span class="k">$((</span><span class="nv">$SIZE</span> <span class="o">-</span> <span class="m">1</span><span class="k">))</span>
<span class="k">done

for </span>f <span class="k">in</span> <span class="k">$(</span>find ./ <span class="nt">-regex</span> <span class="s1">'.*\(.png\|.PNG\)$'</span> | <span class="nb">sed</span> <span class="s2">"s/^</span><span class="se">\.\/</span><span class="s2">//"</span><span class="k">)</span>
<span class="k">do
</span><span class="nb">echo</span> <span class="s2">"convert png file "</span><span class="nv">$f</span><span class="s2">" to jpg file"</span>
<span class="nb">mv</span> <span class="nv">$f</span> <span class="s2">"tmp</span><span class="nv">$f</span><span class="s2">"</span>
convert <span class="s2">"tmp</span><span class="nv">$f</span><span class="s2">"</span> <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$f</span> | <span class="nb">sed</span> <span class="s1">'s/\..*$/.jpg/'</span><span class="k">)</span>
<span class="nb">rm</span> <span class="s2">"tmp</span><span class="nv">$f</span><span class="s2">"</span>
<span class="k">done

</span><span class="nb">echo</span> <span class="s2">"done"</span>
</code></pre></div></div> <p>原理非常粗暴o_o ….</p> <p>就是一步步减小质量和分辨率直到文件符合大小为止</p> <p>感觉还不错(。・∀・)ノ</p> <p>然后陆陆续续有一些同学来找我压缩图片</p> <p>其实下个50M+的格式工程手动一步步缩小就能解决, 但都太懒了</p> <p>然后我也懒得不行..连敲一行命令都不想</p> <p>然后想把脚本给他…( ＿ ＿)ノ｜</p> <p>但不行啊总不能让别人每个人都升级Windows 10 Insider再按个WSL吧</p> <p>然后我就想要不写个UI吧（￣︶￣）↗　</p> <p>然后不想写个Web APP啊..毕竟找不到免费的国内的性能比较好的VPS, 然后我又不会PHP╯︿╰</p> <p>要不写native的吧?</p> <p>然后我又不会WPF…要不用PyQT? SWING? GTK C?</p> <p>然后我就想起好像还有个JavaFX（*゜ー゜*）</p> <p><img src="/images/2017-04-02-scale-jpg-init/javafxisland.png" alt="" /></p> <p>然后随手搜了一下(●’◡’●)</p> <p>看起来挺容易上手的(ง •_•)ง</p> <p>确实也挺容易上手的(￣▽￣)”</p> <p>然后三两下就入了门,</p> <p>配合过硬的Google技能\(￣︶￣*\))</p> <p>然后Scale JPG就写好了</p> <p>真的只要吧照片文件拖进去就好了</p> <p>真的非常方便!( ´･･)ﾉ(._.`)</p> <p>真的非常方便写!</p> <p>MVC框架非常清晰干净,(哪来的M…VC框架(+_+)?</p> <p>然后用Java1.8, 再也不用一堆匿名listener, lamda函数来回嵌套♪(^∇^*)</p> <p>zenjava的javafx-maven-plugin一行命令就打包好了exe</p> <p>然后, 然后这边又好多然后… 最后我来谈谈怎么用</p> <h1 id="怎么用">怎么用</h1> <p>首先下载…</p> <p>虽然是小工具…但因为捆绑了Jre8巨大无比…40MB</p> <p><a href="http://pan.baidu.com/s/1eSmohhC">百度网盘</a></p> <p><a href="https://github.com/c0ldcat/scale-jpg/releases/download/v1.0/scale-jpg-1.0.exe">Github</a></p> <p>首先看看演示视频</p> <video src="/images/2017-04-02-scale-jpg-init/scale-jpg.mp4" controls="controls" preload="none"> Your browser does not support the video tag. </video> <p>然后解压</p> <p><img src="/images/2017-04-02-scale-jpg-init/extract.png" alt="" /></p> <p>然后打开</p> <p><img src="/images/2017-04-02-scale-jpg-init/app.png" alt="" /></p> <p>这里有几个选项, 在MenuBar - Edit - Setting</p> <p><img src="/images/2017-04-02-scale-jpg-init/setting.png" alt="" /></p> <ul> <li> <p>第一个Initial Scale: 初始压缩大小, 就是我第一个尝试的照片尺寸(百分比)</p> </li> <li> <p>第二个Scale Step: 每步减少的百分百</p> <ul> <li>这两个一般不用管</li> </ul> </li> <li> <p>最后一个是File Size, 文件限制大小, 单位是KB</p> </li> </ul> <p>点OK保存</p> <p>然后把文件拖进去</p> <p><img src="/images/2017-04-02-scale-jpg-init/drag.png" alt="" /></p> <p>然后在原文件目录下就生成好了缩放好的文件(orginal name-scaled.jpg)</p> <p>好, 搞定!</p> </div> </div></div> <div id="blog-data-page-pagination"></div> <div id="blog-data-nav"> <ul> <li> <a href="/" class="icon-home">home</a> </li> <li> <a href="/posts" class="icon-create">post</a> </li> <li> <a href="/projects" class="icon-code">projects</a> </li> <li> <a href="/tags" class="icon-bookmark">tags</a> </li> <li> <a href="/love" class="icon-favorite">love</a> </li> </ul> </div> <div id="blog-data-icp">沪ICP备18037676号</div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.runtime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vuetify@1.1.14/dist/vuetify.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="/js/blog.db2021ef5bad500114c7.js"></script></body> </html>
